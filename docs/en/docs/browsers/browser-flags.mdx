import { AvatarBrowsers } from "../../../../theme/components/avatar-group/browsers.tsx";

<AvatarBrowsers browsers={["chrome", "firefox", "edge"]} />

# Browser flags

Control browser launch behavior for debugging, automation, and runtime experiments.

Tune browser launch behavior without changing extension source code. Extension.js merges browser flags from your `extension.config.*` and applies them in `dev`, `preview`, and `start` flows.

## How it works

Define flags in configuration:

- `browser.<target>.browserFlags`
- `commands.dev|start|preview.browserFlags`
- optional `excludeBrowserFlags` to remove defaults or user flags (runner-dependent behavior)

Merge precedence is browser defaults -> command defaults -> CLI-selected command context.

## Flag capabilities

| Config key                             | What it does                                             |
| -------------------------------------- | -------------------------------------------------------- |
| `browser.<target>.browserFlags`        | Sets default launch flags for a specific browser target. |
| `commands.dev.browserFlags`            | Adds or overrides flags for `dev` runs.                  |
| `commands.start.browserFlags`          | Adds or overrides flags for `start` runs.                |
| `commands.preview.browserFlags`        | Adds or overrides flags for `preview` runs.              |
| `browser.<target>.excludeBrowserFlags` | Removes matching default or user flags for a target.     |
| `commands.<name>.excludeBrowserFlags`  | Removes flags in a command-specific context.             |

{/* VIDEO_DEMO_SOON: Show browser-level flags plus command-level overrides and the final launch flags used at runtime. */}
![Video demo soon: browser flag merge precedence](https://placehold.co/960x540?text=Video+demo+soon)

### Example configuration

```js
export default {
  browser: {
    chrome: {
      browserFlags: ["--disable-web-security", "--auto-open-devtools-for-tabs"],
      excludeBrowserFlags: ["--mute-audio"],
    },
    firefox: {
      browserFlags: ["--devtools", "--new-instance"],
      excludeBrowserFlags: ["--devtools"],
    },
  },
};
```

## Chromium vs Firefox behavior

- **Chromium family (`chrome`, `edge`, `chromium`, `chromium-based`)**
  - Starts from an internal default flag set, then appends your `browserFlags`.
  - `excludeBrowserFlags` removes matching default flags (exact-match filtering).
  - `--load-extension=...` is managed by Extension.js and filtered out from user-provided flags.

- **Firefox/Gecko family (`firefox`, `gecko-based` / `firefox-based`)**
  - Uses user-provided `browserFlags` (no large default flag bundle like Chromium).
  - `excludeBrowserFlags` removes user flags by prefix matching.

{/* VIDEO_DEMO_SOON: Show Chromium and Firefox launches using different flag behavior from the same config. */}
![Video demo soon: chromium vs firefox flag behavior](https://placehold.co/960x540?text=Video+demo+soon)

## Supported targets and references

| Browser        | Usage                                    | More Information                                                                       |
| -------------- | ---------------------------------------- | -------------------------------------------------------------------------------------- |
| Chrome         | `extension dev --browser=chrome`         | [Chrome Flags](https://peter.sh/experiments/chromium-command-line-switches/)           |
| Edge           | `extension dev --browser=edge`           | [Edge Flags](https://docs.microsoft.com/en-us/deployedge/microsoft-edge-policies)      |
| Firefox        | `extension dev --browser=firefox`        | [Firefox Flags](https://developer.mozilla.org/en-US/docs/Mozilla/Command_Line_Options) |
| Chromium-based | `extension dev --browser=chromium-based` | [Chromium Flags](https://peter.sh/experiments/chromium-command-line-switches/)         |
| Gecko-based    | `extension dev --browser=gecko-based`    | Firefox-based browsers share the same flags as Firefox.                                |

Use binary flags when needed for engine-based targets:

- `--chromium-binary=...`
- `--gecko-binary=...`

{/* VIDEO_DEMO_SOON: Show engine-based target launch with custom browser binary and target-specific flags. */}
![Video demo soon: engine target flags with custom binaries](https://placehold.co/960x540?text=Video+demo+soon)

## Best practices

- **Add only necessary flags**: Minimize long flag lists to reduce flaky or non-portable setups.
- **Prefer `excludeBrowserFlags` over replacing defaults**: Remove only what conflicts with your workflow.
- **Do not pass `--load-extension` manually**: Extension.js manages extension loading flags internally.
- **Validate per browser family**: A flag working in Chromium may be invalid or ignored in Firefox.

## Next steps

- Learn more about [Browser Preferences](./browser-preferences.mdx).
- Learn more about [Browser Profile](./browser-profile.mdx).
